# Shared Libraries Index

**Location:** `docs/03_Code_Reference/03_Shared_Libraries/`

This directory contains comprehensive documentation for the core C++ and VB.NET shared libraries used throughout the MHC/MEM system.

---

## Library Documentation

### [OSUB - Operation Subroutines](osub.md)

**Source:** `D:\ICIS\AuroDev\clogan\AuroDev\MSVC Programs\osub`

Auto-generated database access routines providing standardized CRUD operations for database tables. Includes functions for SYS, MOVS, STK, LOAD, and other tables.

**Key Features:**
- Primary key selection
- Loop-based record iteration
- Insert, Update, Delete operations
- Count and Sum aggregations
- History tracking support

**Important:** These files are generated by `p_ut_makdb` - do not modify directly.

---

### [CCSUB - Common Control Subroutines](ccsub.md)

**Source:** `D:\ICIS\AuroDev\clogan\AuroDev\Base\trunk\MSVC Programs\ccsub`

C++ classes for equipment control, communication, and system management. These classes encapsulate device-specific logic for stackers, vehicles, PLCs, and other equipment types.

**Key Classes:**
- `cc_stk` - Stacker crane control
- `cc_vehicle` - AGV/RTNX vehicle control  
- `cc_mudp` - MUDP protocol communication
- `cc_plc` - PLC communication abstraction
- `cc_str` - String manipulation utilities
- `cc_sys` - System-level control
- `cc_mem` - Mapped memory management

---

### [CSUB - Common Subroutines](csub.md)

**Source:** `D:\ICIS\AuroDev\clogan\AuroDev\MSVC Programs\csub`

Fundamental utility functions used throughout the MHC/MEM system including logging, messaging, registry access, and date/time handling.

**Key Functions:**
- `cs_log_printf` - Formatted logging
- `cs_msg_put/get/peek` - Message queue operations
- `cs_reg_read/write` - Registry access
- `cs_dtm_*` - Date/time manipulation

---

## Constants and Definitions

### [ICISDefines.vb - VB.NET Constants](ICISDefines.md)

**Source:** `D:\ICIS\AuroDev\clogan\AuroDev\MSVB Programs\dilg\mhcMenu\ICISDefines.vb`

System-wide constants, enumerations, and shared variables for VB.NET dialogs and components. This file centralizes definitions used across all VB.NET projects.

**Key Sections:**
- System Type Constants (`gsSystem_Type`)
- Date/Time Format Constants
- Communication Classes (`COM`)
- Device Status Enumerations (`DEV`, `ESTAT`)
- Station Types and Modes (`ST.TYP`, `ST.MODES`)
- Move Status Constants (`MOVS.STATUS`, `MOVS.ACTION`, `MOVS.TYPE`)
- Load and Inventory Constants (`LOAD`, `INVT`)
- Vehicle Constants (`VEHICLE.FUNC`, `VEHICLE.SCHD`, `VEHICLE.COMP`)
- Stacker Constants (`SR.FUNC`, `SR.SCHD`, `SR.MODES`)
- Location Constants (`LOCN`)
- System Maximums (`MAX`)
- Station Error Codes

**Important:** Must be kept synchronized with `global_prm.h`.

---

### [global_prm.h - C++ Global Parameters](global_prm.md)

**Source:** `D:\ICIS\AuroDev\clogan\AuroDev\MSVC Programs\incl\global_prm.h`

Central header file containing system-wide constants, type definitions, macros, and project-specific configuration values for the C++ codebase.

**Key Sections:**
- Type Definitions (`GP_BOOL`, `GP_UINT`, etc.)
- Return Codes (`GP.GOOD`, `GP.BAD`, etc.)
- Log Level Constants (`GP_LOGLVL_0` through `GP_LOGLVL_10`)
- Project-Specific Maximums (`GP_MAX_*`)
- Macro Definitions (`GP_TRACE`, `FILELINE`)
- Control Character Definitions (`GP_CC_*`)
- PLC Definitions
- File Path Definitions
- Program Name Definitions (`GP_prgnam_*`)
- Global Variables (`gg_text*`, `gg_prgnam`, etc.)
- GP Class Reference (full enumeration documentation)

**Important:** Must be kept synchronized with `ICISDefines.vb`.

---

## Quick Reference: Constant Cross-Reference

| Concept | C++ (global_prm.h) | VB.NET (ICISDefines.vb) |
|---------|-------------------|------------------------|
| Communication Status | `GP.COM.ONLI/OFFL` | `ICISDefines.COM.ONLI/OFFL` |
| Device Types | `GP.DEV.STACKER` | `ICISDefines.DEV.STACKER` |
| Station Types | `GP.ST.TYP.PDIN` | `ICISDefines.ST.TYP.PDIN` |
| Station Modes | `GP.ST.MODES.STORE` | `ICISDefines.ST.MODES.STORE` |
| Move Status | `GP.MOVS.STATUS.PEND()` | `ICISDefines.MOVS.STATUS.PEND` |
| Vehicle Functions | `GP.VEHICLE.FUNC.MOVE` | `ICISDefines.VEHICLE.FUNC.MOVE` |
| Stacker Functions | `GP.SR.FUNC.STOR` | `ICISDefines.SR.FUNC.STOR` |
| Return Codes | `GP.GOOD/GP.BAD` | N/A (use standard VB.NET) |

---

## Quick Reference: Common Constants

### Return Codes (C++ Only)

| Constant | Value | Meaning |
|----------|-------|---------|
| `GP.GOOD` | 0 | Success |
| `GP.BAD` | -1 | Failure |
| `GP.FAILED` | -2 | Specific test failure |
| `GP.TIME_OUT` | -3 | Operation timed out |
| `GP.RACK_FULL` | -5 | No storage space |

### Log Levels

| Level | Usage |
|-------|-------|
| 0-2 | Errors and critical messages |
| 3-4 | Standard operational messages |
| 5-6 | Verbose/debug information |
| 7-10 | Trace-level debugging |

### Special Strings

| Constant | Value | Usage |
|----------|-------|-------|
| `GP_INTRAN_STR` | "IN-TR-AN" | In-transit location |
| `GP_OUTSYS_STR` | "OU-TS-YS" | Out-of-system location |
| `GP_DUMMY_ID` | "DUMM" | Dummy load prefix |
| `GP_EMPTY_SERIAL` | "0000000000000000" | Empty pallet |
| `GP_NOREAD_SERIAL` | "NOREAD" | BCR no-read |

---

## Usage Guidelines

### When Adding New Constants

1. **Determine Scope:** If used in both VB.NET and C++, add to both files
2. **Match Values:** Ensure numeric values are identical
3. **Match Order:** Keep enumeration order consistent
4. **Add Comments:** Include `// Must Match ICISDefines.vb` or equivalent
5. **Update Documentation:** Add to both this index and the detailed file

### When Modifying Existing Constants

1. **Check Both Files:** Modifications must be made in both C++ and VB.NET
2. **Test Both Sides:** Verify UI and background processes still work
3. **Update Documentation:** Keep all references current

---

## Related Documentation

- [OSUB Detailed Reference](osub.md) - Database access patterns
- [CCSUB Detailed Reference](ccsub.md) - Equipment control classes
- [CSUB Detailed Reference](csub.md) - Utility functions
- [ICISDefines Complete Reference](ICISDefines.md) - All VB.NET constants
- [global_prm.h Complete Reference](global_prm.md) - All C++ constants

---

*Last Updated: 12/23/2024*
